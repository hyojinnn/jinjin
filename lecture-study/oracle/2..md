# 2. 그룹함수와 단일행함수



* 함수(FUNCTION)

컬럼 값을 읽어서 계산한 결과를 리턴한다.

단일행함수(SINGLE ROW) 함수

컬럼에 기록된 N개의 값을 읽어서 N개의 결과를 리턴

그룹(GROUP) 함수

컬럼에 기록된 N개의 값을 읽어서 한 개의 결과를 리턴

함수를 사용할 수 있는 위치

SELECT절, WHERE절, GROUP BY절, HAVING절, ORDER BY절

그룹함수

SUM, AVG, MAX, MIN, COUNT

SUM(숫자가 기록된 컬럼명) 합계를 구하여 리턴

AVG(숫자가 기록된 컬럼명) 평균을 구하여 리턴

MIN(컬럼명) 컬럼에서 가장 작은 값 리턴

MAX(컬럼명) 컬럼에서 가장 큰 값 리턴

COUNT(\* | 컬럼명) 행의 갯수를 헤아려서 리턴

COUNT({DISTINCT 컬럼명} 중복을 제거한 행 갯수 리턴

COUNT(\*) NULL을 포함한 전체 행 갯수 리턴

COUNT(컬럼명) NULL을 제외한 실제 값이 기록된 행 갯수 리턴

문자 관련 함수

LENGTH, LENGTHB, SUBSTR, UPPER, LOWER, INSTR...

INSTR('문자열' | 컬럼명, 문자', 찾을 위치의 시작값, \[빈도])

LPAD / RPAD 주어진 칼럼 문자열에 임의의 문자열을 덧붙여 길이 N의 문자열을 반환하는 함수

LTRIM / RTRIM 주어진 컬럼이나 문자열 왼쪽/오른쪽에서 지정한 문자 혹은 문자열을 제거한

```
                     나머지를 반환하는 함수이다.
```

TRIM 주어진 컬럼이나 문자열의 앞/뒤에 지정한 문자를 제거

SUBSTR 컬럼이나 문자열에서 지정한 위치로부터 지정한 갯수의 문자열을 잘라서 리턴하는 함수

SUBSTRB 바이트 단위로 추출하는 함수

LOWER / UPPER / INITCAP 대소문자 변경해주는 함수

LOWER(문자열 | 컬럼) 소문자로 변경해주는 함수

UPPER(문자열 | 컬럼) 대문자로 변경해주는 함수

INITCAP 앞글자만 대문자로 변경해주는 함수

CONCAT 문자열 혹은 컬럼 두 개를 입력받아 하나로 합친 후에 리턴

REPLACE 컬럼 혹은 문자열을 입력받아 변경하고자 하는 문자열을 변경하려고 하는 문자열로

```
            바꾼 후 리턴
```

숫자 처리 함수

ABS, MOD, ROUND, FLOOR, TRUNC, CEIL

ABS(숫자 | 숫자로 된 컬럼명) 절대값 구하는 함수

MOD(숫자 | 숫자로 된 컬럼명, 숫자 | 숫자로 된 컬럼명) 두 수를 나누어서 나머지를 구하는 함수

처음 인자는 나누어지는 수, 두뻔 째 인자는 나눌 수

ROUND(숫자로 된 컬럼명, (위치)) 반올림 해서 리턴하는 함수

FLOOR(숫자 | 숫자로 된 컬럼명) 내림처리하는 함수

TRUNC(숫자 | 숫자로 된 컬럼명, \[위치]) 내림처리(절삭)함수

CEIL(숫자 | 숫자로된 컬럼명) 올림처리 함수

날짜 처리 함수

SYSDATE, MONTHS\_BETWEEN, ADD\_MONTHS, NEXT\_DAY, LAST\_DAY, EXTRACT

SYSDATE 시스템에 저장되어 있는 날짜를 반환하는 함수

MONTHS\_BETWEEN(날짜, 날짜) 두 날짜의 개월 수 차이를 숫자로 리턴하는 함수

ADD\_MONTH(날짜, 숫자) 날짜에 숫자만큼 개월 수 더해서 리턴

NEXT\_DAY(기준날짜, 요일(문자|숫자) 기준 날짜에서 구하려는 요일에 가장 가까운 날짜 리턴

LAST DAY(날짜) 해당 월의 마지막 날짜를 구하여 리턴

EXTRACT 년, 월, 일 정보를추출하여 리턴하는 함수

EXTRACT(YEAR FROM 날짜) 년도만 추출

EXTRACT(MONTH FROM 날짜) 월만 추출

EXTRACT(DAY FROM 날짜) 날짜만 추출

RR과 YY의 차이

RR은 두자리 년도를 네자리로 바꿀 때 바꿀년도가 50년 미만 2000년도를 적용 50년 이상이면 1900년 적용

형변환 함수

TO\_CHAR(날짜, \[포맷]) 날짜형 데이터를 문자형 데이터로 변경

TO\_CHAR(숫자, \[포맷]) 숫자형 데이터를 문자형 데이터로 변경

TO\_DATE 문자 혹은 숫자형 데이터를 날짜형 데이터로 변환하여 리턴

TO\_DATE(문자형데이터, \[포맷])

TO\_DATE(숫자, \[포맷])

WHERE HIRE\_DATE > '20000101'; -- 자동형변환 된다(문자열은 날짜로 자동형변환된다)

WHERE HIRE\_DATE > 20000101; -- 자동형변환 안된다(숫자는 날짜로 자동형변환 안된다)

TO\_NUMBER(문자데이터, \[포맷]) 문자데이터를 숫자로 리턴

NULL 처리 함수

NVL(컬럼명, 컬럼값이 NULL일 때 바꿀값)

NVL2(컬럼명, 바꿀값1, 바꿀값2) 해당 컬럼이 값이 있으면 바꿀값1로 변경, 해당 컬럼이 NULL이면 바꿀값2로 변경

선택함수

DECODE(계산식 | 컬럼명, 조건값1, 선택값1, 조건값2, 선택값2...)

마지막 인자로 조건값 없이 선택값을 작성하면 아무것도 해당하지 않을 때 마지막에 작성한 선택값을 무조건 선택한다.
